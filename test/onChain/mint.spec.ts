import {describe, expect, test} from 'vitest'
import {applyParamsToMinterScript} from '../../src/onChain/mint'

describe('minting script', () => {
  describe('applyParamsToMinterScript', () => {
    test('should apply params when endDate is provided', async () => {
      const script = await applyParamsToMinterScript({
        collectionIdHex:
          '65636634626232662d326563632d343564362d396365302d393861636562393063663538',
        authorityKeyHex:
          'b47c7c0ca235a188003fde3e6a583141a89125f346572bb87e81a870',
        endDate: 100,
      })

      expect(script).toEqual(
        '59015c5901590101003333232323232322322322253330073232323232533300c3370e900018069baa00113232533300e3233001001375860266028602860286028602860286028602860226ea8018894ccc04c00452809991299980919b8f00200e14a22660080080026eb8c050004c0540044004528299980699b8748000c038dd500409919299980799b8748008c040dd5000899b88375a602660226ea800400858c048c040dd51809180998081baa301230133013301330133013301330133010375400a6eb4c044c03cdd50040a51375c6020601c6ea800458c03cc04000cc038008c034008c034004c024dd50008a4c26cac6eb8004dd7000ab9a5573aaae7955cfaba1574498126582465636634626232662d326563632d343564362d396365302d393861636562393063663538004c011e581cb47c7c0ca235a188003fde3e6a583141a89125f346572bb87e81a870004c0106d8799f1864ff0001',
      )
    })

    test('should apply params when endDate is not provided', async () => {
      const script = await applyParamsToMinterScript({
        collectionIdHex:
          '65636634626232662d326563632d343564362d396365302d393861636562393063663538',
        authorityKeyHex:
          'b47c7c0ca235a188003fde3e6a583141a89125f346572bb87e81a870',
      })

      expect(script).toEqual(
        '5901595901560101003333232323232322322322253330073232323232533300c3370e900018069baa00113232533300e3233001001375860266028602860286028602860286028602860226ea8018894ccc04c00452809991299980919b8f00200e14a22660080080026eb8c050004c0540044004528299980699b8748000c038dd500409919299980799b8748008c040dd5000899b88375a602660226ea800400858c048c040dd51809180998081baa301230133013301330133013301330133010375400a6eb4c044c03cdd50040a51375c6020601c6ea800458c03cc04000cc038008c034008c034004c024dd50008a4c26cac6eb8004dd7000ab9a5573aaae7955cfaba1574498126582465636634626232662d326563632d343564362d396365302d393861636562393063663538004c011e581cb47c7c0ca235a188003fde3e6a583141a89125f346572bb87e81a870004c0103d87a800001',
      )
    })
  })
})
